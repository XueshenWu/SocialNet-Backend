
  <!DOCTYPE html>
  <html>
    <head>
      <title>profile.controller.ts</title>
      <link href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" type="text/css" rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/mode/javascript/javascript.min.js" type="text/javascript" charset="utf-8"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.58.2/codemirror.min.css" type="text/css" rel="stylesheet">
<script src="..\..\..\..\assets\source-file.js" type="text/javascript" charset="utf-8"></script>
<link href="..\..\..\..\assets\source-file.css" type="text/css" rel="stylesheet">
    </head>
    <body>
    <div style="margin-top:3em" class="ui container"><h1 class="ui header"><a href="..\..\..\..\index.html">TypeScript coverage report</a></h1><table style="margin-top:2em" class="ui celled table"><thead class=""><tr class=""><th class="">Filename</th><th class="">Percent</th><th class="">Threshold</th><th class="">Total</th><th class="">Covered</th><th class="">Uncovered</th></tr></thead><tbody class=""><tr class="negative"><td class="">src\byan\profile\profile.controller.ts</td><td class="">73.86%</td><td class="">80%</td><td class="">88</td><td class="">65</td><td class="">23</td></tr></tbody></table><textarea id="editor" readonly="" style="margin-top:3em">import { Controller, Get, Post, Body, Patch, Param, Delete, NotFoundException } from &#x27;@nestjs/common&#x27;;
import { ProfileService } from &#x27;./profile.service&#x27;;
// import { CreateProfileDto } from &#x27;./dto/create-profile.dto&#x27;;
// import { UpdateProfileDto } from &#x27;./dto/update-profile.dto&#x27;;
// import { Prisma as PgPrisma } from &#x27;@prisma/pg&#x27;;
import UpdateProfileDto from &#x27;../../xueshen/dto/updateProfileDto&#x27;;
// import { NotFoundError } from &#x27;rxjs&#x27;;

@Controller(&#x27;api&#x27;)
export class ProfileController {
  constructor(private readonly profileService: ProfileService) {}
  // constructor(private readonly dbService: DbService) {}

  // @Post()
  // create(@Body() createProfileDto: CreateProfileDto) {
  //   return this.profileService.create(createProfileDto);
  // }

  // @Post()
  // create(@Body() createProfileDto: CreateProfileDto) {
  //   return this.profileService.create(createProfileDto.email, createProfileDto.password);
  // }

  // @Get()
  // findAll() {
  //   return this.profileService.findAll();
  // }

  // @Get(&#x27;:id&#x27;)
  // findOne(@Param(&#x27;id&#x27;) id: string) {
  //   return this.profileService.findOne(+id);
  // }

  // only for testing
  // @Post()
  // create(@Body() createProfileDto: PgPrisma.ProfileCreateInput) {
  //   console.log(createProfileDto.customId, createProfileDto.name);
  //   return this.profileService.create(createProfileDto);
  // }

  // besed on the service provided by DbService
  // @Patch(&#x27;:id&#x27;)
  // @Post(&#x27;:id&#x27;)
  // update(@Param(&#x27;id&#x27;) userId: string, @Body() updateProfileDto: PgPrisma.ProfileUpdateInput) {
  //   console.log(updateProfileDto.customId, updateProfileDto.user);
  //   return this.profileService.update(userId, updateProfileDto);
  // }

  @Post(&#x27;/getProfile&#x27;)
  async getProfileByUserId(@Body() userId: string): Promise&lt;Record&lt;string, any&gt;&gt; {
    try {
      const userProfile = await this.profileService.getProfileByUserId(userId);

      if (!userProfile) {
        return {
          data:{},
          error: {
            message: &quot;user not found&quot;
          }
        }
      }

      return {
        data:{
          profile: userProfile
        },
        error: {}
      }
    } catch (err) {
      // const userProfile = await this.profileService.getProfileByUserId(userId);
      // if (!userProfile) {
      //   throw new NotFoundException(&#x27;User profile not found&#x27;);
      // }
      return {
        data:{},
        error: {
          message: err.message
        }
      }
    }
  }

  @Post(&#x27;/updateProfile&#x27;)
  async updateProfile(@Body() updateProfileDto: UpdateProfileDto): Promise&lt;Record&lt;string, any&gt;&gt; {
    // console.log(updateProfileDto.userId);
    // return this.dbService.updateProfile(updateProfileDto);

    try {
      const updatedUserProfile = await this.profileService.updateProfile(updateProfileDto);

      return {
        error: {}
      }
    } catch (err) {
      return {
        error: {
          message: err.message
        }
      }
    }
  }

  @Post(&#x27;/getProfileByEmail&#x27;)
  async getProfileByEmail(@Body() email: string): Promise&lt;Record&lt;string, any&gt;&gt; {
    try {
      const user = await this.profileService.getUserByEmail(email);
      
      if (!user) {
        return {
          data:{},
          error: {
            message: &quot;user not found&quot;
          }
        }
      }

      const userProfile = await this.profileService.getProfileByUserId(user.id);
      return {
        data:{
          profile: userProfile
        },
        error: {}
      }
    } catch (err) {
      // const userProfile = await this.profileService.getProfileByUserId(userId);
      // if (!userProfile) {
      //   throw new NotFoundException(&#x27;User profile not found&#x27;);
      // }
      return {
        data:{},
        error: {
          message: err.message
        }
      }
    }
  }
    
  // getProfileByEmail
  // +queryuserbyemail
  // +queryprofilebyuserid
  
  //visitProfle(uid, vid)
  // @Post(&#x27;/profile/:id&#x27;)
  // visitProfle(@Body() updateProfileDto: UpdateProfileDto) {
  //   console.log(updateProfileDto.userId);
  //   // return this.dbService.updateProfile(updateProfileDto);
  //   return this.profileService.updateProfile(updateProfileDto);
  // }

  // @Delete(&#x27;:id&#x27;)
  // remove(@Param(&#x27;id&#x27;) id: string) {
  //   return this.profileService.remove(+id);
  // }
}
</textarea><pre id="annotations" style="display:none">[{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:51,&quot;character&quot;:12,&quot;text&quot;:&quot;userProfile&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:53,&quot;character&quot;:11,&quot;text&quot;:&quot;userProfile&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:64,&quot;character&quot;:10,&quot;text&quot;:&quot;profile&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:64,&quot;character&quot;:19,&quot;text&quot;:&quot;userProfile&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:76,&quot;character&quot;:10,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:76,&quot;character&quot;:19,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:76,&quot;character&quot;:23,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:68,&quot;character&quot;:13,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:96,&quot;character&quot;:10,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:96,&quot;character&quot;:19,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:96,&quot;character&quot;:23,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:93,&quot;character&quot;:13,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:105,&quot;character&quot;:12,&quot;text&quot;:&quot;user&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:107,&quot;character&quot;:11,&quot;text&quot;:&quot;user&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:116,&quot;character&quot;:12,&quot;text&quot;:&quot;userProfile&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:116,&quot;character&quot;:71,&quot;text&quot;:&quot;user&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:116,&quot;character&quot;:76,&quot;text&quot;:&quot;id&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:119,&quot;character&quot;:10,&quot;text&quot;:&quot;profile&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:119,&quot;character&quot;:19,&quot;text&quot;:&quot;userProfile&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:131,&quot;character&quot;:10,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:131,&quot;character&quot;:19,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:131,&quot;character&quot;:23,&quot;text&quot;:&quot;message&quot;,&quot;kind&quot;:1},{&quot;file&quot;:&quot;src\\byan\\profile\\profile.controller.ts&quot;,&quot;line&quot;:123,&quot;character&quot;:13,&quot;text&quot;:&quot;err&quot;,&quot;kind&quot;:1}]</pre></div>
    <p class="footer-text">TypeScript Coverage Report generated by <a href="https://github.com/plantain-00/type-coverage">type-coverage</a> and <a href="https://github.com/alexcanessa/typescript-coverage-report">typescript-coverage-report</a> at Thu, 04 Apr 2024 16:26:48 GMT</p>
    </body>
  </html>
  